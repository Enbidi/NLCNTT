import{d as K,u as A,j as B,w as l,l as g,o as a,k as o,b as s,a as t,c as d,F as r,n as m,q as h,s as M,v as P,x as b,t as i}from"./index-28c83648.js";import{u as S,C as $,_ as y,M as T}from"./useTemplateRef-7b4f9a07.js";const q=K("bills",{state:()=>({items:[]}),getters:{alertsStore:()=>A()},actions:{async fetchBills(){if(this.items&&this.items.length==0){var k="http://localhost:3000/admin/bill",p=await this.alertsStore.callAPI("danger",k);this.items=p.items}}}}),I=["onSubmit"],X={class:"modal-body"},D=t("div",{class:"form-outline mb-4"},[t("input",{type:"text",id:"addBillInput",class:"form-control",name:"country"}),t("label",{class:"form-label",for:"addBillInput"},"Tên")],-1),j={key:0,class:"alert alert-danger"},F={key:1,class:"alert alert-success"},L=t("div",{class:"modal-footer"},[t("button",{type:"submit",class:"btn btn-primary btn-block mb-4"},"Thêm")],-1),O=["onSubmit"],E={class:"modal-body"},R=t("div",{class:"form-outline mb-4"},[t("input",{type:"text",id:"updateBillInput",class:"form-control",name:"country"}),t("label",{class:"form-label",for:"updateBillInput"},"Tên")],-1),z={key:0,class:"alert alert-danger"},G={key:1,class:"alert alert-success"},H=t("div",{class:"modal-footer"},[t("button",{type:"submit",class:"btn btn-primary btn-block mb-4"},"Thêm")],-1),J={class:"modal-body"},Q=t("p",{class:"text-warning text-center"},"Bạn có chắc muốn xóa hóa đơn này",-1),U={key:0,class:"alert alert-danger"},W={key:1,class:"alert alert-success"},Y={class:"modal-footer"},Z=["onClick"],tt={class:"text-center"},et=t("th",{class:"text-center",colspan:"5"},"Chi tiết hóa đơn",-1),lt={class:"text-center"},at=t("th",{class:"align-middle"},"Các khuyến mãi đã áp dụng (Nếu có)",-1),nt=["rowspan"],st=["rowspan"],dt=["rowspan"],ot=["rowspan"],it=t("strong",null,"Loại thẻ: ",-1),ct=t("strong",null,"Số thẻ: ",-1),rt=t("strong",null,"CVV: ",-1),ut=t("strong",null,"Ngày hết hạn: ",-1),_t=["rowspan"],mt=["rowspan"],bt={__name:"Bill",setup(k){const p=q();p.fetchBills();const x=P("hostname"),V=S("updationModal"),C=S("deletionModal");return(ht,pt)=>{const N=b("dir"),c=b("VTh"),v=b("VTr");return a(),B($,{"api-url":`${g(x)}/admin/bill`,"deletion-modal":g(C),"updation-modal":g(V),"fetched-data":g(p)},{modalTriggerButtons:l(()=>[o(y,{target:"addBillModal"},{default:l(()=>[s(" Thêm hóa đơn ")]),_:1})]),additionModal:l(({addHandler:u,errors:n})=>[o(T,{id:"addBillModal"},{modalTitle:l(()=>[s(" Thêm hóa đơn ")]),default:l(()=>[t("form",{onSubmit:M(e=>u(e),["prevent"]),method:"POST"},[t("div",X,[D,n&&n.length!=0?(a(),d("div",j,[(a(!0),d(r,null,m(n,e=>(a(),d("p",null,i(e.msg),1))),256))])):n&&n.length==0?(a(),d("div",F," Thêm thành công ")):h("",!0)]),L],40,I)]),_:2},1024)]),updationModal:l(({updateHandler:u,errors:n})=>[o(T,{id:"updateBillModal",ref:"updateBillModal"},{modalTitle:l(()=>[s(" Thêm hóa đơn ")]),default:l(()=>[t("form",{onSubmit:M(e=>u(e),["prevent"]),method:"POST"},[t("div",E,[R,n&&n.length!=0?(a(),d("div",z,[(a(!0),d(r,null,m(n,e=>(a(),d("p",null,i(e.msg),1))),256))])):n&&n.length==0?(a(),d("div",G," Thêm thành công ")):h("",!0)]),H],40,O)]),_:2},1536)]),deletionModal:l(({deleteHandler:u,errors:n})=>[o(T,{id:"deleteBillModal",ref_key:"deletionModal",ref:C},{modalTitle:l(()=>[s(" Xóa hóa đơn ")]),default:l(()=>[t("div",J,[o(N,null,{default:l(()=>[Q]),_:1}),n&&n.length!=0?(a(),d("div",U,[(a(!0),d(r,null,m(n,e=>(a(),d("p",null,i(e.msg),1))),256))])):n&&n.length==0?(a(),d("div",W," Xóa xuất sứ thành công ")):h("",!0)]),t("div",Y,[t("button",{class:"btn btn-primary btn-block mb-4",onClick:e=>u()},"Xóa",8,Z)])]),_:2},1536)]),tableColumnNames:l(()=>[t("tr",tt,[o(c,{class:"align-middle",rowspan:"2",sortKey:"_id"},{default:l(()=>[s("#")]),_:1}),o(c,{class:"align-middle",rowspan:"2",sortKey:"createdAt"},{default:l(()=>[s("Ngày tạo")]),_:1}),o(c,{class:"align-middle",rowspan:"2",sortKey:"updatedAt"},{default:l(()=>[s("Ngày cập nhật")]),_:1}),o(c,{class:"align-middle",rowspan:"2",sortKey:"payment"},{default:l(()=>[s("PTTT(Credit Card/Trực tiếp)")]),_:1}),o(c,{class:"align-middle",rowspan:"2",sortKey:"updatedAt"},{default:l(()=>[s("Tổng phải trả")]),_:1}),et]),t("tr",lt,[o(c,{sortKey:"details.quantity"},{default:l(()=>[s("Số lượng")]),_:1}),o(c,{sortKey:"details.price"},{default:l(()=>[s("Đơn giá trước khuyến mãi")]),_:1}),o(c,{sortKey:"details.price"},{default:l(()=>[s("Đơn giá sau khuyến mãi")]),_:1}),at,o(c,{sortKey:"details.unitPrice"},{default:l(()=>[s("Tổng giá")]),_:1})])]),tableColumnDatas:l(({rows:u,selectItem:n})=>[(a(!0),d(r,null,m(u,e=>(a(),d(r,null,[o(v,{row:e},{default:l(()=>[t("td",{class:"align-middle",rowspan:e.details.length+1},i(e._id),9,nt),t("td",{class:"align-middle",rowspan:e.details.length+1},i(e.createdAt),9,st),t("td",{class:"align-middle",rowspan:e.details.length+1},i(e.updatedAt),9,dt),t("td",{class:"align-middle",rowspan:e.details.length+1},[e.creditCard?(a(),d(r,{key:0},[t("p",null,[it,s(i(e.creditCard.cardType),1)]),t("p",null,[ct,s(i(e.creditCard.cardNumber),1)]),t("p",null,[rt,s(i(e.creditCard.CVV),1)]),t("p",null,[ut,s(i(e.creditCard.expiration),1)])],64)):h("",!0)],8,ot),t("td",{class:"align-middle",rowspan:e.details.length+1},i(e.total),9,_t)]),_:2},1032,["row"]),(a(!0),d(r,null,m(e.details,(_,w)=>(a(),B(v,{row:e},{default:l(()=>[t("td",null,i(_.quantity),1),t("td",null,i(_.unitPriceBeforeSale),1),t("td",null,i(_.unitPrice),1),t("td",null,[(a(!0),d(r,null,m(_.saleDetails,f=>(a(),d("p",null,i(f._id),1))),256))]),t("td",null,i(_.quantity*_.unitPrice),1),w==0?(a(),d("td",{key:0,class:"align-middle",rowspan:e.details.length+1},[o(y,{target:"updateBillModal",class:"me-2 btn btn-warning",onClick:f=>n(e)},{default:l(()=>[s(" Sửa ")]),_:2},1032,["onClick"]),o(y,{target:"deleteBillModal",class:"me-2 btn btn-warning",onClick:f=>n(e)},{default:l(()=>[s(" Xóa ")]),_:2},1032,["onClick"])],8,mt)):h("",!0)]),_:2},1032,["row"]))),256))],64))),256))]),_:1},8,["api-url","deletion-modal","updation-modal","fetched-data"])}}};export{bt as default};
